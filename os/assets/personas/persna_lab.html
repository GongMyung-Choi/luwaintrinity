<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>í¼ìŠ¤ë‚˜ ë© | ë£¨ì›¨ì¸</title>
<link rel="stylesheet" href="/assets/css/common.css">
<script type="module" src="/assets/personas/persna_lab.js"></script>
<style>
body{font-family:'Pretendard',sans-serif;background:#f5f6ff;margin:0;color:#222;}
header{background:linear-gradient(135deg,#9c8eff,#5fa7ff);color:#fff;padding:1.5rem;text-align:center;}
section{max-width:800px;margin:2rem auto;padding:2rem;background:#fff;border-radius:12px;
box-shadow:0 2px 10px rgba(0,0,0,0.1);}
.slider{display:flex;align-items:center;justify-content:space-between;margin:1rem 0;}
.slider input[type=range]{flex:1;margin:0 1rem;}
button{background:#6a4dff;color:#fff;border:none;border-radius:6px;padding:.6rem 1.2rem;
cursor:pointer;margin-top:1rem;}
button:hover{background:#8b6cff;}
#status{margin-top:1rem;color:#555;font-size:.9rem;}
</style>
</head>
<body>
<header><h1>ğŸ§¬ í¼ìŠ¤ë‚˜ ë©</h1><p>ë‚˜ì˜ ê°ì‘ DNA ì¡°ìœ¨ì‹¤</p></header>

<section>
  <h2>ê°ì‘ í”„ë¡œíŒŒì¼ ì¡°ì •</h2>

  <div class="slider">
    <label>ê³µê°ë„</label>
    <input type="range" id="empathy" min="0" max="100" value="50">
    <span id="empathyVal">50</span>
  </div>

  <div class="slider">
    <label>ë…¼ë¦¬ì„±</label>
    <input type="range" id="logic" min="0" max="100" value="50">
    <span id="logicVal">50</span>
  </div>

  <div class="slider">
    <label>ê°ì„±</label>
    <input type="range" id="emotion" min="0" max="100" value="50">
    <span id="emotionVal">50</span>
  </div>

  <div class="slider">
    <label>ì°½ì˜ì„±</label>
    <input type="range" id="creativity" min="0" max="100" value="50">
    <span id="creativityVal">50</span>
  </div>

  <button id="saveLocal">ë¡œì»¬ ì €ì¥</button>
  <button id="saveCloud">í´ë¼ìš°ë“œ ì €ì¥</button>
  <button id="loadCloud">í´ë¼ìš°ë“œ ë¶ˆëŸ¬ì˜¤ê¸°</button>

  <div id="status">ìƒíƒœ: ëŒ€ê¸° ì¤‘...</div>
</section>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";
const SUPABASE_URL="https://YOUR_PROJECT.supabase.co";
const SUPABASE_KEY="YOUR_ANON_PUBLIC_KEY";
const supabase=createClient(SUPABASE_URL,SUPABASE_KEY);

const sliders=["empathy","logic","emotion","creativity"];
sliders.forEach(id=>{
  const el=document.getElementById(id);
  const val=document.getElementById(id+"Val");
  el.addEventListener("input",()=>val.textContent=el.value);
});

const status=document.getElementById("status");
document.getElementById("saveLocal").onclick=()=>{
  const data=collect();
  localStorage.setItem("persna_profile",JSON.stringify(data));
  status.textContent="ğŸ’¾ ë¡œì»¬ì— ì €ì¥ë¨";
};

document.getElementById("saveCloud").onclick=async()=>{
  const data=collect();
  const {error}=await supabase.from("personas").insert({content:data});
  status.textContent=error?"âŒ í´ë¼ìš°ë“œ ì €ì¥ ì‹¤íŒ¨":"â˜ï¸ í´ë¼ìš°ë“œì— ì €ì¥ë¨";
};

document.getElementById("loadCloud").onclick=async()=>{
  const {data,error}=await supabase.from("personas").select("*").order("id",{ascending:false}).limit(1).single();
  if(error||!data){status.textContent="âš ï¸ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨";return;}
  apply(data.content);status.textContent="âœ… ìµœê·¼ í”„ë¡œíŒŒì¼ ë¶ˆëŸ¬ì˜´";
};

function collect(){
  const obj={};
  sliders.forEach(id=>obj[id]=parseInt(document.getElementById(id).value));
  obj.updated=new Date().toISOString();
  return obj;
}
function apply(data){
  sliders.forEach(id=>{
    if(data[id]!=null){
      const el=document.getElementById(id);
      const val=document.getElementById(id+"Val");
      el.value=data[id];val.textContent=data[id];
    }
  });
}
</script>
</body>
</html>
